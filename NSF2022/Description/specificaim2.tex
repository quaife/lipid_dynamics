\subsection{Specific Aim 2: Efficient, high-order methods for
large-scale simulations}
\label{sec:specificaim2}
\begin{itemize}
%  \item Make clear that we know how to address NSI and fast summation
  \item Talk about collision as per talk with Bryce
%  \item Wen's paper can be used to give numbers on how large or a
%    problem could hypothetically be considered
%  \item Emphasize that we've learned a lot from just $\mathcal(O)(100)$
%    particles, but now it's time to do more
  \item Confinement and rheology
\end{itemize}

% ----------------------------------------------------------------------
Over the past decade, there has been an explosion of interest in
small-scale processes that utilize capillary forces and van der Waals
interactions to coordinate movement and bind microscopic components in
solvent~\cite{Pandey2011, Zhang2017, Siontorou2017}. Additionally,
hydrodynamic interactions are central to fabricate complex,
three-dimensional microstructures~\cite{Dasgupta2017, Leong2007,
Reynolds2019, Cho2010}. Hydrodynamic effects cannot be ignored since
they, like for the rates of biological functions like pore
dynamics~\cite{RYHAM20112929}, set the rate of dissipation. In Specific
Aim 2, we propose novel and efficient high-order numerical methods to
simulate dynamic assembly of particles under the HAP in a viscous
solvent. As described in~\eqref{eqn:stokes} and illustrated in
Figure~\ref{fig:flow_map}, the solvent phase is modeled by the Stokes
equations for an incompressible, viscous fluid, and these equations are
coupled to the non-linear screened-Laplace equation~\eqref{eqn:phase}
through viscous and hydrophobic stress balance. 
 
%\label{subsec:specific_aim_2}
%\begin{wrapfigure}[14]{r}{0.61\textwidth}
%  \centering{\includegraphics[width=0.60\textwidth]{Figures/domain.pdf}}
%    \vspace{-15pt}
%    \caption{\label{fig:flow_map} \footnotesize A collection of 3D
%    amphiphilic particles suspended in a solvent. The solvent velocity
%    satisfies the Stokes equations, and the hydrophobic forces depend on
%    the solvent activity that satisfies the screened Laplace equation.
%    The geometry is updated by solving the mobility problem.} 
%\end{wrapfigure}
The HAP model requires solving exterior problems for the order
parameter~\eqref{eqn:phase} and the Stokes equations~\eqref{eqn:stokes}.
We will develop methods based on combinations of volume and layer
potentials, and inexact Newton's method. As mentioned in
Section~\ref{sec:bie}, numerical methods to solve these integral
equations (IEs) have several advantages over their PDE-based
counterpart. The PIs have demonstrated that IEs are a powerful tool to
simulate two-dimensional suspensions of amphiphilic
particles~\cite{Fu2018_SIAM, FuQuRyYo22, fu-ryh-qua-you2022}. Moreover,
elements of these formulations have been described in three
dimensions~\cite{ying_2006, manasthesis, rac-gre2016}. This proposal
will extend the two-dimensional methods to more general amphiphilic
particle models and also to three dimensions. In addition, the methods
will allow us to use results we have shown for $\mathcal{O}(100)$
grains, and extend them to suspensions with 100X--1000X more grains.
These methods will be motivated by models and analysis developed in
Specific Aims 1 and 3. \S\ref{subsec:AC} describes how the non-linear
Allen-Cahn equation~\eqref{eq:SL} will be iteratively solved using an IE
formulation. Then, \S\ref{subsec:NumericalIssues} describes how we will
combine accurate quadrature and fast summation methods to accelerate the
time to accurate solutions. A natural extension to create simulations
that are realizable by experimentalists is to include confinement, and
this is discussed in \S\ref{subsec:Confinement}. This extension will
also allow us to study new rheological properties of the suspensions.
Finally, \S\ref{subsec:timeStepping} proposes collision-aware adaptive
time stepping methods.

% ----------------------------------------------------------------------
\subsubsection{Iterative methods for the Allen-Cahn HAP model}
\label{subsec:AC}

The PIs have developed numerical methods to solve~\eqref{eqn:phase} when
$f(u) = u^2$---this choice results in the linear screened Laplace
equation. For a more general $f$, such as a double well potential, we
will interpret the solution of~\eqref{eqn:phase} as the root finding
problem for
\begin{align}
  \label{eq:F}
  J[u] = -\rho^2 \Delta u + \tfrac{1}{2}f'(u).
\end{align}
This non-linear PDE will be solved with Newton's method
\begin{align*}
  u^{N+1} = u^{N} - \alpha (dJ^N)^{-1} J(u^N),
\end{align*}
where $dJ^N = -\rho^2 \Delta + \tfrac{1}{2}f''(u^N)$ is the Fr\'{e}chet
derivative of $F$, and $\alpha$ is the step size which will be
determined using backtracking. As expected, the biggest computational
challenge is solving $- \rho^2 \Delta v + \tfrac{1}{2}f''(u^{N}) v =
J[u^N]$. Solving this variable coefficient PDE with an integral equation
is challenging since a fundamental solution is not readily available.
However, since $f''(u_0) = f''(u_1) = 2a(u_1 - u)0)^2 + 2c$, f' We
propose to instead use an inexact Newton's method where $dJ^{-1}$ is
defined in terms of the continuous, piecewise quadratic approximation
\begin{align*}
  f(u) \approx \tilde{f}(u) = bu + \begin{cases}
    a(u - u_0)^2, &\mbox{if } u \leq (u_0 + u_1)/2, \\
    (u - u_1)^2 + \tfrac{1}{4}(a-1)(u_0-u_1)^2 , &\mbox{if } u > (u_0 + u_1)/2,
  \end{cases}
\end{align*}
where $a>0$, and the resulting inexact Newton's method requires solving
the piecewise constant PDE
\begin{align}
  \label{eq:screenedPoisson}
  -\rho^2 \Delta v + \tfrac{1}{2}\tilde{f}''(u^{N})v = J[u^N],
\end{align}
which is a screened Poisson equation with piecewise a constant screening
coefficient. We test the efficacy of exact and inexact Newton's method
applied to~\eqref{eq:F} in $(0,1)$ by discretizing $dJ$ with a
second-order finite difference method. The choice of parameters $a$,
$b$, $u_0$, and $u_1$ result in the double well potential illustrated in
Figure~\ref{fig:CA}(a), and both the exact and inexact Newton's methods
converge to the solution in Figure~\ref{fig:CA}(b).
Figure~\ref{fig:CA}(c) shows the max norm of the residual at each Newton
iterate when using the exact second derivative (red curve) and the
piecewise constant approximate (blue curve). While the inexact Newton's
method requires roughly twice as many iterations to reach of a tolerance
of $10^{-4}$, each iteration is significantly cheaper in higher
dimensions.

%\begin{wrapfigure}[27]{l}{1.8in}
%  \vspace{-4pt}
%  \centering
%  \input{figures/doublewell.tikz} 
%  \caption{\label{fig:CA} (a) The double well potential $u_0 =
%  0.5$, $u_1 = 2$, $a = 1$, $b = 0.4$. (b) The solution of the
%  Allen-Cahn equation~\eqref{eq:SL}. (c) The convergence of the exact
%  and inexact Newton's methods.}
%\end{wrapfigure}
Having demonstrated that the inexact Newton method converges in one
dimension, it will be coupled with IE formulations to 
solve~\eqref{eq:SL} in two and three dimensions. We first partition
$\Omega$ into $\Omega_0 = \{\xx \in \Omega \:|\: u(\xx) < (u_0 +
u_1)/2\}$ and $\Omega_1 = \{\xx \in \Omega \:|\: u(\xx) > (u_0 +
u_1)/2\}$, and we let $\Lambda = \{\xx \in \Omega \:|\: u(\xx) = (u_0 +
u_1)/2 \}$ be their common boundary, and we let $G_0$ be the fundamental
solution of $(-\rho^2 \Delta + a)$ and $G_1$ be the fundamental
solution of $(-\rho^2 \Delta + 1)$. Then, the solution
of~\eqref{eq:screenedPoisson} can be written as $u = u^P + u^H$ where
$u^P$ is a volume potential and $u^H$ is a layer potential. The volume
potential is
\begin{align*}
  u^{P}(\xx) = \int_{\Omega_i} G_i(\xx,\yy) J[u^N](\yy)\, d\yy, 
    \quad i = 1,2,
\end{align*}
but it is discontinuous across $\Lambda$ and does not satisfy the
prescribed hydrophobic boundary conditions on the particles $\Gamma_i$.
Assuming the particles are entirely contained in the hydrophobic region,
the boundary conditions will be enforced with the layer potentials
\begin{align*}
  u^{H}(\xx) = \begin{cases}
    \displaystyle\int_{\Lambda} G_0(\xx,\yy) \eta_0(\yy) \, ds_\yy + 
    \displaystyle\int_{\Gamma} \pderiv{}{\nn_\yy} G_0(\xx,\yy)
      \sigma(\yy) \,ds_\yy, \quad & \xx \in \Omega_0, \\
    \displaystyle\int_{\Lambda} G_1(\xx,\yy) \eta_1(\yy) \, ds_\yy,
     & \xx \in \Omega_1.
  \end{cases}
\end{align*}
The density functions $\sigma$, $\eta_0$, and $\eta_1$ are determined so
that $u = u^P + u^H$ satisfies the hydrophobic boundary condition on
$\Gamma = \cup_i \Gamma_i$, and that it is continuous and differentiable
across $\Lambda$. This approach of using IEs to solve elliptic PDEs with
piecewise constant coefficients has successfully been used in other
application such as scattering~\cite{hyu-bar2014, che-cho-cai2018}.

% ----------------------------------------------------------------------
\subsubsection{Increased accuracy and reduced CPU time}
\label{subsec:NumericalIssues}
While IE formulations of PDEs have several advantages, several
challenges must be overcome before the code can be used to simulate
systems with large numbers of grains. For example, when grains are close
to one another, which is inevitable in dense suspensions, the resulting
integrals are nearly-singular. This issue is well-known in the IE
community and several algorithms have been developed in the last 30
years. An incomplete list of methods that address near-singular
integration include panel-based methods~\cite{helsing_2008a,
helsing_tutorial_2012}, Quadrature by Expansions
(QBX)~\cite{din-hua-mar-tan2021, klo-bar-gre-one2013, ste-bar2022,
af2018sisc}, and interpolation-based methods~\cite{ying_2006,
qua-bir2014, rah-vee-zor-bir2015}. The proposed research, which is
described next,  will combine several methods including singularity
subtraction, analytic function theory, and spherical basis
representations.

In two-dimensions, analytic function theory can be used to derive a
quadrature method whose error is uniformly bounded~\cite{bar2014,
bar-wu-vee2015, ioa-pap-per1991}, but these works only show how to apply
the method to the two-dimensional Laplace and Stokes equations. PI BQ
recently showed that these quadrature methods can be extended to other
PDEs with singularity subtraction~\cite{che-lin-her-qua2022}. For
example, the fundamental solution of the screened Laplace
equation~\eqref{eqn:phase} involves the modified Bessel function of the
second kind, $K_0(\|\xx - \yy\|)$. The behavior of this function as $\yy
\rightarrow \xx$ is $K_0(\alpha \|\xx - \yy\|) = \log\|\xx - \yy\| +
S(\xx - \yy)$, where $S(\xx - \yy)$ is continuously differentiable. This
suggests a quadrature scheme for where the aforementioned quadrature
method is applied to the $\log\|\xx - \yy\|$ kernel, and high-order
methods~\cite{tre-wei2014} are applied to integrals involving the smooth
kernel $S(\xx - \yy)$.Similar techniques, which they call subtraction
techniques, have been considered by Camille Carvalho and her
colleagues~\cite{car2021, car2020, car-kha-kim2018}.  These methods are
particularly powerful when computing gradients of layer potentials which
is required, for example, when computing the water-order
stress~\eqref{eqn:stressbalance}.

In three dimensions, the quadrature methods are much more challenging.
Singularity subtraction methods can be applied, but analytic function
theory is no longer applicable. Singularity subtraction methods have
been applied using, for example, smoothed variations of
the~\cite{beale1, cor2001, tlu-bea2019}. Alternatively, efficient
quadrature methods can be applied directly to accurately compute
singular and near-singular integrals~\cite{khayat_2005,
gimbutas2013sisc}. However, since we are interested in round (2D) and
spherical (3D) grains, we will exploit the fact that integrals can be
computed exactly after transforming the integrals to to a Fourier (2D)
or spherical harmonic (3D) basis. This technique can be used to evaluate
layer potentials for both Stokes~\cite{cor-vee2018} and the screened
Laplace equation~\cite{koh-cor-che-vee2021}.

Another facet to consider when choosing the quadrature rule is its
ability to be applied efficiently. Since carefully chosen IE
formulations require a mesh-independent number of GMRES
iterations~\cite{cam-ips-kel-mey-xue1996}, the required CPU time is
proportional to the cost of a matrix-vector multiplication that can be
performed in optimal or near-optimal time with the fast multipole method
(FMM)~\cite{fmm5} and its extensions~\cite{fmm1, fmm2, fmm3, fmm4, fmm6,
fmm7, ros-ols2016}. PI BQ is experienced with applying FMMs for the
Stokes equation~\cite{qua-bir2014, bys-sha-qua2020} and the screened
Laplace equation~\cite{kro-qua2011, qua2011}. Many of these methods rely
on analytic expansions of the PDE's fundamental solution, but recent
work has demonstrated that a kernel-independent method applied to
suspensions of 80,000 spheres can be simulated with only $\sim$10
seconds per time step on 1792 compute cores~\cite{Yan2019}.

%
%Furthermore, to reduce the
%number of GMRES iterations, the efficacy of preconditioning strategies
%such as the inverse Fast Multipole Method (IFMM)~\cite{cou-pou-dar2017}
%and domain decomposition~\cite{che-bir2021} will be investigated. PI BQ
%used the IFMM to precondition Stokes equations~\cite{qua-cou-dar2018}. A
%suite of other preconditioners including sparse approximate
%inverses~\cite{che2000} and multigrid~\cite{hem-sch1981, sch1982} will
%be investigated.

% ----------------------------------------------------------------------
\subsubsection{Incorporating confinement}
\label{subsec:Confinement}
In experiments, it is known that interactions between bounding walls and
grains cannot be ignored~\cite{qua-gan-you2021,
KaouiHartingMisbah2011_PRE, her-sto-gra2005}. Therefore, the necessary
modifications to the code will be performed so that confinement can be
considered. PI BQ has considered suspensions with confinement for
several projects including dynamic suspensions~\cite{qua-bir2014,
bys-sha-qua2020} and porous media~\cite{chi-moo-qua2020,
dea-qua-bir-jua2018, moo-che-chi-qua2022, qua-gan-you2021}.


% ----------------------------------------------------------------------
\subsubsection{Collision-aware suspensions with adaptive time stepping}
\label{subsec:timeStepping}

A numerical issue when simulating the self-assembly of amphiphilic
particles is avoiding particle collision. The hydrophobic attraction
potential drives the amphiphilic particles towards one another and this
leads to physical contact in finite time. Such particle collisions in a
dense, rigid-body suspension are a great challenge and can be a
bottleneck in large-scale simulations. We propose to remedy this
computational challenge by developing novel high-order adaptive time
stepping methods. PI BQ developed a high-order adaptive time
stepping method for hydrodynamic suspensions \cite{qua-bir2016}, and it
has served as a robust method to simulate processes including mixing and
adhesion in suspensions~\cite{qua-vee-you2019, kab-qua-bir2017}.
Following this previous work, the proposed work will use a spectral
deferred correction method~\cite{dut-gre-rok2000} since it iteratively
applies a low-order, single-step method to achieve high-order accuracy.
At each time step, we will compute the total force and torque of the
system which is computationally cheap and physically zero, and therefore
provides an estimate of the local truncation error. PI BQ's experience
is that error estimates based on physical constraints, such as force-
and torque-free conditions, appropriately determine adaptive time step
sizes so that the dynamics are resolved without the computational
expense of embedded Runge-Kutta methods, step-doubling, Richardson
extrapolation.


