\subsection{Specific Aim 2: Efficient, high-order methods for
large-scale simulations}
% ----------------------------------------------------------------------
Over the past decade, there has been an explosion of interest in
small-scale processes that utilize capillary forces and van der Waals
interactions to coordinate movement and bind microscopic components in
solvent~\cite{Pandey2011, Zhang2017, Siontorou2017}. Additionally,
hydrodynamic interactions are central to fabricate complex,
three-dimensional microstructures~\cite{Dasgupta2017, Leong2007,
Reynolds2019, Cho2010}. Hydrodynamic effects cannot be ignored since
they, like for the rates of biological functions like pore
dynamics~\cite{RYHAM20112929}, set the rate of dissipation. In Specific
Aim 2, we propose novel and efficient high-order numerical methods to
simulate dynamic assembly of particles under HAP potential in a viscous
solvent. As described in~\eqref{eq:stokes1}--\eqref{eq:stokes3} and
illustrated in Figure~\ref{fig:flow_map}, the solvent phase is modeled
by the Stokes equations for an incompressible, viscous fluid, and these
equations are coupled to the screened-Laplace equation~\eqref{eq:SL}
through viscous and hydrophobic stress balance. 
 
%\label{subsec:specific_aim_2}
%\begin{wrapfigure}[14]{r}{0.61\textwidth}
%  \centering{\includegraphics[width=0.60\textwidth]{Figures/domain.pdf}}
%    \vspace{-15pt}
%    \caption{\label{fig:flow_map} \footnotesize A collection of 3D
%    amphiphilic particles suspended in a solvent. The solvent velocity
%    satisfies the Stokes equations, and the hydrophobic forces depend on
%    the solvent activity that satisfies the screened Laplace equation.
%    The geometry is updated by solving the mobility problem.} 
%\end{wrapfigure}
The HAP model requires solving exterior problems for the order
parameter~\eqref{eq:SL} and the Stokes
equations~\eqref{eq:stokes1}--\eqref{eq:stokes3}. We will develop
methods based on combinations of volume and layer potentials. Numerical
methods to solve these integral equations (IEs) have several advantages
over their PDE-based counterpart: by construction, they satisfy
far-field and mass conservation conditions; only $\partial\Omega$ needs
to be discretized for layer potentials; carefully chosen IEs result in a
well-conditioned linear system that is solved with a mesh-independent
number of GMRES iterations; and high-order or spectral accuracy is
attainable with appropriate quadrature methods. The PIs have
demonstrated that IEs are a powerful tool to simulate two-dimensional
suspensions of amphiphilic particles~\cite{Fu2018_SIAM, FuQuRyYo20}.
Moreover, elements of these formulations have been described in three
dimensions~\cite{ying_2006, manasthesis, rac-gre2016}. This proposal
will extend the two-dimensional methods to more general amphiphilic
particle models that satisfy~\eqref{eq:SL}, and all the methods can
naturally be extended to three dimensions. \S\ref{subsec:AC} describes
how the non-linear Allen-Cahn equation~\eqref{eq:SL} will be iteratively
solved using BIE formulations. Then, \S\ref{subsec:NumericalIssues}
describes how we will combine preconditioning strategies with fast
summation methods to accelerate the time to solution, and
\S\ref{subsec:timeStepping} describes adaptive time stepping methods,

\subsubsection{Iterative methods for the Allen-Cahn HAP model}
\label{subsec:AC}

The PIs have developed numerical methods to solve~\eqref{eq:SL} when
$f(u) = u^2$---this choice results in the linear screened Laplace
equation. For a more general $f$, such as a double well potential, we
will interpret the solution of~\eqref{eq:SL} as the root finding problem
\begin{align}
  \label{eq:F}
  J[u] = -\rho^2 \Delta u + f'(u).
\end{align}
This non-linear PDE will be solved with Newton's method
\begin{align*}
  u^{N+1} = u^{N} - \alpha (dJ^N)^{-1} J(u^N),
\end{align*}
where $dJ^N = -\rho^2 \Delta + f''(u^N)$ is the Fr\'{e}chet derivative
of $F$, and $\alpha$ is the step size which will be determined using
backtracking. As expected, the biggest computational challenge is
solving $- \rho^2 \Delta v + f''(u^{N}) v = J[u^N]$. Solving this
variable coefficient PDE with an integral equation is challenging since
a fundamental solution is not readily available. We propose to instead
use an inexact Newton's method where $dJ^{-1}$ is defined in terms of
the piecewise quadratic approximation
\begin{align*}
  f(u) \approx \tilde{f}(u) = bu + \begin{cases}
    a(u - u_0)^2, &\mbox{if } u \leq (u_0 + u_1)/2, \\
    (u - u_1)^2, &\mbox{if } u > (u_0 + u_1)/2.
  \end{cases}
\end{align*}
and the resulting inexact Newton's method requires solving the piecewise
constant PDE
\begin{align}
  \label{eq:screenedPoisson}
  -\rho^2 \Delta v + \tilde{f}''(u^{N})v = J[u^N],
\end{align}
which is a screened Poisson equation with piecewise a constant screening
coefficient. We test the efficacy of exact and inexact Newton's method
applied to~\eqref{eq:F} in $(0,1)$ by discretizing $dJ$ with a
second-order finite difference method. The choice of parameters $a$,
$b$, $U_0$, and $U_1$ result in the double well potential illustrated in
Figure~\ref{fig:CA}(a), and both the exact and inexact Newton's methods
converge to the solution in Figure~\ref{fig:CA}(b).
Figure~\ref{fig:CA}(c) shows the max norm of the residual at each Newton
iterate when using the exact second derivative (red curve) and the
piecewise constant approximate (blue curve). While the inexact Newton's
method requires roughly twice as many iterations to reach of a tolerance
of $10^{-4}$, each iteration is significantly cheaper in higher
dimensions.

\begin{wrapfigure}[28]{l}{1.8in}
  \vspace{-4pt}
  \centering
  \input{figures/doublewell.tikz} 
  \caption{\label{fig:CA} (a) The double well potential $u_0 =
  0.5$, $u_1 = 2$, $a = 1$, $b = 0.4$. (b) The solution of the
  Allen-Cahn equation~\eqref{eq:SL}. (c) The convergence of the exact
  and inexact Newton's methods.}
\end{wrapfigure}
Having demonstrated that the inexact Newton method converges in one
dimension, it will be coupled with IE formulations to to
solve~\eqref{eq:SL} in two and three dimensions. We first partition
$\Omega$ into $\Omega_0 = \{\xx \in \Omega \:|\: u(\xx) < (u_0 +
u_1)/2\}$ and $\Omega_1 = \{\xx \in \Omega \:|\: u(\xx) > (u_0 +
u_1)/2\}$, and we let $\Lambda = \{\xx \in \Omega \:|\: u(\xx) = (u_0 +
u_1)/2 \}$ be their common boundary, and we let $G_0$ be the fundamental
solution of $(-\rho^2 \Delta - 2a)$ and $G_1$ be the fundamental
solution of $(-\rho^2 \Delta + 2)$. Then, the solution
of~\eqref{eq:screenedPoisson} can be written as $u = u^P + u^H$ where
$u^P$ is a volume potential and $u^H$ is a layer potential. The volume
potential is
\begin{align*}
  u^{P}(\xx) = \int_{\Omega_i} G_i(\xx,\yy) J[u^N](\yy)\, d\yy, 
    \quad i = 1,2,
\end{align*}
but it is discontinuous across $\Lambda$ and does not satisfy the
prescribed hydrophobic boundary conditions on the particles $\Gamma_i$.
Assuming the particles are entirely contained in the hydrophobic region,
the boundary conditions will be enforced with the layer potentials
\begin{align*}
  u^{H}(\xx) = \begin{cases}
    \displaystyle\int_{\Lambda} G_0(\xx,\yy) \eta_0(\yy) \, ds_\yy + 
    \displaystyle\int_{\Gamma} \pderiv{}{\nn_\yy} G_0(\xx,\yy)
      \sigma(\yy) \,ds_\yy, \quad & \xx \in \Omega_0, \\
    \displaystyle\int_{\Lambda} G_1(\xx,\yy) \eta_1(\yy) \, ds_\yy,
     & \xx \in \Omega_1.
  \end{cases}
\end{align*}
The density functions $\sigma$, $\eta_0$, and $\eta_1$ are determined so
that $u = u^P + u^H$ satisfies the hydrophobic boundary condition on
$\Gamma = \cup_i \Gamma_i$, and that it is continuous and differentiable
across $\Lambda$.

% ----------------------------------------------------------------------
\subsubsection{Accelerating the iterative solvers}
\label{subsec:NumericalIssues}

%
%\begin{wrapfigure}[20]{r}{2.5in}
%\vspace*{-13pt}
%\centerline{\includegraphics[width=2.4in]{figures/integrands}}
%\vspace*{-13pt}
%  \caption{{\footnotesize The Fourier modes of
%  $K(\mathbf{x_0},\mathbf{y})$ and $K_2(\mathbf{x_0},\mathbf{y})$ where
%  $|\mathbf{x_0}| = 0.99$, $\mathbf{y} \in \partial\Omega$, and
%  $\Omega$ is the unit disk. The trapezoid rule applied to the red
%  integrand has large amounts of error, but the trapezoid rule is much
%  more accurate when applied to the blue integrand. Since the difference
%  between the red and blue curves can be accurately computed with the
%  barycentric quadrature rule, the quadrature error applied to layer
%  potentials for the screened Laplace equation will be uniformly bounded
%  in $\Omega$.}}
%\label{fig:integrands}
%\end{wrapfigure}
Discretizations of carefully chosen BIEs can be solved with a
mesh-independent number of GMRES
iterations~\cite{cam-ips-kel-mey-xue1996}. Therefore, the required CPU
time is proportional to the cost of a matrix-vector multiplication that
can be performed in optimal or near-optimal time with the fast multipole
method (FMM)~\cite{fmm5} and its extensions~\cite{fmm1, fmm2, fmm3,
fmm4, fmm6, fmm7, fmm8}. PI BQ is experienced with applying FMMs for the
Stokes equation~\cite{qua-bir2014, bys-sha-qua2020} and the screened
Laplace equation~\cite{kro-qua2011, qua2011}.  Alternatively, fast
direct solvers avoid iteration~\cite{fds2, fds3, fds4, fds5, fds6, fds7,
ho2016cpam1, minden2016, minden2017siammms}, but often require a large
amount of computational overhead, and this makes them less practical for
problems with moving geometries. Alternatively, fast direct solver
techniques can be used to develop efficient preconditioning strategies
such as the inverse Fast Multipole Method (IFMM)~\cite{cou-pou-dar2017}.
PI BQ used the IFMM to precondition Stokes
equations~\cite{qua-cou-dar2018}. A suite of other preconditioners
including sparse approximate inverses~\cite{che2000} and
multigrid~\cite{hem-sch1981, sch1982} will be investigated.
%
%Nearly touching bodies is ubiquitous in self-assembly of amphiphilic
%particles, and this results in nearly-singular integrands. Quadrature
%methods for these integrands have received a lot of attention in two and
%three dimensions~\cite{alpert, kapur, sidi, duffy, bruno1, bruno2,
%davis_1984, graglia_2008, hackbusch_sauter_1994, jarvenpaa_2003,
%khayat_2005, schwab_1992, ying_2006, beale1, schwab_1992, ggq1, ggq2,
%ggq3, helsing_2008a, helsing_tutorial_2012, klockner2013jcp, qbx2,
%wala2019jcp, af2018sisc, siegel2018jcp, rachh2017jcp, ding2019arxiv,
%bar2014}. The trapezoid rule is the workhorse for two-dimensional BIEs
%since it achieves spectral accuracy when integrands are not
%nearly-singular~\cite{tre-wei2014}. To address nearly-singular
%integrands of two-dimensional BIEs, we will use a {\em barycentric
%quadrature rule} that only requires a slight modification of the
%trapezoid rule~\cite{ioa-pap-per1991}. In its current form, this method
%requires the layer potential to satisfy Laplace or Stokes
%equations~\cite{bar-wu-vee2015, chi-moo-qua2020}, but the PIs will
%extend the method to layer potentials for the screened Laplace equation.
%This will be done by recognizing that the fundamental solution of the
%screened Laplace equation can be decomposed as $K(\mathbf{x},\mathbf{y})
%= K_1(\mathbf{x},\mathbf{y}) + K_2(\mathbf{x},\mathbf{y})$, where
%$K_1(\mathbf{x},\mathbf{y}) = -\log|\mathbf{x} - \mathbf{y}|$ and
%$K_2(\mathbf{x},\mathbf{y}) = K(\mathbf{x},\mathbf{y}) + \log|\mathbf{x}
%- \mathbf{y}|$. Then, layer potentials involving
%$K_1(\mathbf{x},\mathbf{y})$ can be accurately computed with the
%barycentric quadrature rule~\cite{ioa-pap-per1991}, and layer potentials
%involving $K_2(\mathbf{x},\mathbf{y})$ can be accurately computed with
%the trapezoid rule since the kernel is bounded for all $\mathbf{x}$ and
%$\mathbf{y}$. The proposed method is demonstrated in
%Figure~\ref{fig:integrands}, where the amplitude of the Fourier modes of
%$K(\mathbf{x_0},\mathbf{y})$ and $K_2(\mathbf{x_0},\mathbf{y})$ are
%plotted. The quadrature error of the trapezoid rule is the sum of the
%unresolved Fourier modes.


% ----------------------------------------------------------------------
\subsubsection{Eliminating contact with adaptive time stepping and
repulsion}
\label{subsec:timeStepping}

A numerical issue when simulating the self-assembly of amphiphilic
particles is avoiding particle collision. The hydrophobic attraction
potential drives the amphiphilic particles towards one another and
this leads to physical contact in
finite time. Such particle collisions in a dense, rigid-body suspension
are a great challenge and can be a bottleneck in large-scale simulations.
We propose two algorithms to remedy this computational challenge:
high-order adaptive time stepping and repulsion forces.

PI BQ developed a high-order adaptive time stepping method for
hydrodynamic suspensions \cite{qua-bir2016}, and it has served as a
robust method to simulate processes including mixing and adhesion in
suspensions~\cite{qua-vee-you2019, kab-qua-bir2017}. The method uses
a single-step, high-order time stepping method and a computationally
cheap estimate of the error. The proposed work will use a spectral
deferred correction method~\cite{dut-gre-rok2000} since it iteratively
applies a low-order, single-step method to achieve high-order accuracy.
To estimate the error, at each time step, we will compute the total force
and torque of the system which is computationally cheap and physically
zero. PI BQ's experience is that error estimates based on physical
constraints such as force- and torque-free conditions appropriately
determine how the time step should be adjusted so that the dynamics are
resolved without the computational expense of techniques such as
embedded Runge-Kutta methods, step-doubling, and Richardson
extrapolation.

%%
%\begin{wrapfigure}[13]{r}{0.30\textwidth}
%\centerline{\includegraphics[width=0.29\textwidth]{figures/BIError.pdf}}
%  \vspace{-8pt}
%\caption{
%\label{fig:bierror}  
%\footnotesize The false color map shows how numerical quadrature of
%  layer potentials loses accuracy near the particle boundaries.  The
%  color bar is for $\log_{10}.$}
%\end{wrapfigure}
%%
Our previous work avoided particle contact through Lennard-Jones body
forces~\cite{Fu2018_SIAM}. Such steep, short-range, steric interactions 
introduce numerical stiffness and limit the time step size. To
remove this stiffness, we propose a geometry-based contact
method~\cite{har-pon-sor-zor2011}. This method has been applied to
vesicle suspensions~\cite{lu-rah-zor2017} and to rigid body suspensions in
two dimensions~\cite{bys-sha-qua2020} and three
dimensions~\cite{Yan2019}. These methods determine repulsion force by
solving a non-linear complementarity problem with a geometric constraint
that the configuration is non-overlapping. In this manner, contact is
avoided without the excessively small time steps required by stiff
Lennard-Jones forces.

%%-------------------------------------------------------------------------------
%\subsubsection{Novel reciprocal identities}
%\label{subsec:reciprocal}
%The force and torque formulas~\eqref{forceandtorque} use the
%hydrophobic stress along the particle boundaries. Unfortunately,
%layer potentials for $\nabla u$ involve hyper-singular integrals and
%this introduces large amounts of quadrature error on the particle
%boundaries (Figure~\ref{fig:bierror}). Therefore, it is useful to devise
%reciprocal identities for the force and torque on body $i$ that do not
%require integration along body $i$. One identity, that we have proved,
%is
%\begin{align}
%    \label{eq:reciprocal}
%{\bf F}_{\text{hydro},i} = \sum_{j \neq i} \int_{\partial P_i}[\boldsymbol{\sigma}_{ij} + \boldsymbol{\sigma}_{ji}]\boldsymbol{\nu}\,\dif S,\quad
%{\bf G}_{\text{hydro},i} = \sum_{j \neq i} \int_{\partial P_i} ({\bf
%  x}-\mathbf{a}_i) \times [\boldsymbol{\sigma}_{ij} +
%  \boldsymbol{\sigma}_{ji}]\boldsymbol{\nu}\,\dif S, 
%\end{align}
%for $i=1,\ldots,N$. Here, $u_i$ is the solution of the screened Laplace
%equation when only the contribution from particle $i$ is considered and
%$\boldsymbol{\sigma}_{ij} = \rho^{-1} u_iu_j \mathbf{I} +
%\rho\left((\nabla u_i \cdot \nabla u_j) \mathbf{I} - 2 \nabla u_i
%\otimes \nabla u_j\right)$. Equation~\eqref{eq:reciprocal} does not
%require knowledge of $\nabla u$ on particle boundary $i$, and this is
%enormously beneficial for calculating the hydrophobic force and torque.
%
%% ----------------------------------------------------------------------
%\subsubsection{Fluctuating hydrodynamics}
%\label{subsec:fluctuating}
%Once algorithms that address quadrature, adaptive time stepping, and
%contact are implemented, we will embark on incorporating fluctuating
%hydrodynamics that are especially important at scales of amphiphilic
%particles. Bao et al.~\cite{Bao17,Bao18} developed two-dimensional BIE
%formulations for Brownian rigid bodies. To satisfy the covariance of the
%rigid body velocities, they use an ill-conditioned, first-kind integral
%equation method. The proposed work will consider a layer potential
%formulation that has much better conditioning properties. This strategy
%was attempted in~\cite{Bao18}, but they claim that a necessary
%regularization of the covariance matrix leads to a drastic loss of
%accuracy in numerical fluctuation-dissipation balance. However, only one
%regularization strategy was considered, and as PI BQ has shown in
%previous work, the regularization choice significantly affects the
%resulting physics~\cite{ong-chr-qua2017}. Therefore, different
%regularization strategies will be investigated with the goal of finding
%well-conditioned BIE formulations that control the accuracy of the
%fluctuation-dissipation balance.


